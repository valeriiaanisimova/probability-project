<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</title>
    <style>
        :root {
            --text: #e4e3fc;
            --background: #010109;
            --primary: #8e83f2;
            --secondary: #650f92;
            --accent: #c33eeb;
            --dark: #0a081a;
            --darker: #050313;
            --light: #e4e3fc;
            --lighter: #f5f4fe;
            --gray: #252535;
            --success: #5db5f6;
            --danger: #f0503f;
            --warning: #fd7e14;
            --card-bg: #121222;
            --text-muted: #9a99b8;
            --bad-value: #ff6b8b;
            /* —Ä–æ–∑–æ–≤—ã–π –¥–ª—è –æ—à–∏–±–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            --good-value: #6ddea7;
            /* –º—è—Ç–Ω—ã–π –¥–ª—è —É—Å–ø–µ—Ö–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
            padding: 0px;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }

        th {
            text-align: left;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: var(--darker);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800;
            letter-spacing: -0.5px;
            transition: all 0.3s;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-muted);
            max-width: 700px;
            margin: 0 auto;
            transition: all 0.3s;
        }

        .section-title {
            font-size: 1.8rem;
            margin-bottom: 30px;
            text-align: center;
            color: var(--primary);
            font-weight: 700;
            position: relative;
            display: inline-block;
            padding-bottom: 10px;
            transition: all 0.3s;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 450px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            border-radius: 3px;
            transition: all 0.3s;
        }

        .scenario-description {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        .scenario-card {
            flex: 1;
            padding: 25px;
            border-radius: 12px;
            background: var(--card-bg);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border-top: 4px solid;
            transition: all 0.3s;
        }

        .current-card {
            border-color: var(--warning);
        }

        .it-card {
            border-color: var(--success);
        }

        .scenario-title {
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .current-title {
            color: var(--warning);
        }

        .it-title {
            color: var(--success);
        }

        .scenario-conditions {
            margin-top: 15px;
        }

        .scenario-conditions h4 {
            margin-bottom: 10px;
            color: var(--text-muted);
        }

        .scenario-conditions ul {
            padding-left: 20px;
        }

        .scenario-conditions li {
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: center;
            border: 1px solid var(--gray);
            transition: all 0.3s;
        }

        .comparison-table th {
            background-color: rgba(142, 131, 242, 0.1);
            color: var(--primary);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        .comparison-table tr:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.03);
        }

        .probability-value {
            font-size: 1.2rem;
            font-weight: 700;
            margin: 5px 0;
        }

        .bad-value {
            color: var(--bad-value);
            /* –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏–∑ —Ç–µ–º—ã */
            padding: 5px 10px;
            border-radius: 5px;
            text-align: center;
        }

        .good-value {
            color: var(--good-value);
            /* –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏–∑ —Ç–µ–º—ã */
            padding: 5px 10px;
            border-radius: 5px;
            text-align: center;
        }

        .details-btn {
            background: rgba(142, 131, 242, 0.2);
            color: var(--primary);
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .details-btn:hover {
            background: rgba(142, 131, 242, 0.4);
        }

        .modal {
            display: none;
            /* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç–æ */
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(1, 1, 9, 0.9);
            /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ */
            justify-content: center;
            align-items: center;
            overflow: auto;
            /* –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ */
        }

        .modal-content {
            background-color: var(--darker);
            padding: 30px;
            border: 1px solid var(--primary);
            border-radius: 12px;
            width: 80%;
            max-width: 1000px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            /* –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –≤—ã—Å–æ—Ç–µ —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π */
            max-height: 90vh;
            overflow-y: auto;
            /* –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω—É—Ç—Ä–∏ –æ–∫–Ω–∞ */
            margin: 40px auto;
            /* –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –∏ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ */
            transition: all 0.3s;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gray);
            top: 0;
            background-color: var(--darker);
            z-index: 10;
        }

        .modal-title {
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: 700;
        }

        .close {
            color: var(--text-muted);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: var(--light);
        }

        .calculation-steps {
            margin-top: 20px;
        }

        .calculation-step {
            margin-bottom: 15px;
        }

        .calculation-formula {
            background: var(--gray);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: monospace;
            border-left: 3px solid var(--primary);
        }

        .parameter-controls {
            padding: 20px;
            background: var(--card-bg);
            border-radius: 8px;
        }

        .parameter-group {
            margin-bottom: 20px;
        }

        .parameter-group h3 {
            margin-bottom: 15px;
            color: var(--primary);
        }

        .parameter-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .parameter-label {
            width: 250px;
            font-size: 0.9rem;
        }

        .parameter-value {
            flex: 1;
        }

        input[type="number"],
        input[type="range"],
        select {
            width: 100%;
            padding: 8px;
            background: var(--gray);
            border: 1px solid var(--text-muted);
            border-radius: 4px;
            color: var(--light);
        }

        input[type="range"] {
            padding: 0;
        }

        .update-btn {
            background: var(--primary);
            color: var(--background);
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .update-btn:hover {
            background: var(--accent);
        }

        .params-btn {
            background: var(--primary);
            color: var(--background);
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 20px auto;
            display: block;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .params-btn:hover {
            background: var(--accent);
        }

        footer {
            text-align: center;
            padding: 30px;
            margin-top: 60px;
            color: var(--text-muted);
            font-size: 0.9rem;
            border-top: 1px solid var(--gray);
        }

        .theme-palette {
            position: fixed;
            bottom: 30px;
            right: 50px;
            z-index: 99;
        }

        .palette-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            transition: all 0.3s;
            position: relative;
            z-index: 101;
        }

        .palette-button:hover {
            transform: scale(1.1);
        }

        .color-options {
            position: absolute;
            bottom: 0px;
            right: -120px;
            display: none;
            background: transparent;
            padding: 0;
            border-radius: 50%;
            width: 300px;
            height: 200px;
            transform-origin: center;
            z-index: 100;
            overflow: hidden;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
            position: absolute;
            top: 50%;
            /* –¶–µ–Ω—Ç—Ä –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
            left: 50%;
            /* –¶–µ–Ω—Ç—Ä –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
            transform-origin: 0 75px;
            /* –¶–µ–Ω—Ç—Ä –≤—Ä–∞—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—É–∫—Ä—É–≥–∞ */
        }

        .color-option:hover {
            transform: translate(-50%, -50%) scale(1.2) rotate(0deg);
            /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }

        .color-option.active {
            border-color: var(--light);
        }

        /* –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –ø–æ –ø–æ–ª—É–∫—Ä—É–≥—É */
        .color-option:nth-child(1) {
            transform: rotate(-90deg) translateX(-50%);
        }

        .color-option:nth-child(2) {
            transform: rotate(-60deg) translateX(-50%);
        }

        .color-option:nth-child(3) {
            transform: rotate(-30deg) translateX(-50%);
        }

        .color-option:nth-child(4) {
            transform: rotate(0deg) translateX(-50%);
        }

        .color-option:nth-child(5) {
            transform: rotate(30deg) translateX(-50%);
        }

        .color-option:nth-child(6) {
            transform: rotate(60deg) translateX(-50%);
        }

        /* –í–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—É–∫—Ä—É–≥–∞ */
        .color-options.show {
            display: flex;
        }


        .color-customizer {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(1, 1, 9, 0.9);
            justify-content: center;
            align-items: center;
            overflow: auto;
        }

        .color-customizer-content {
            background-color: var(--darker);
            padding: 30px;
            border: 1px solid var(--primary);
            border-radius: 12px;
            width: 80%;
            max-width: 500px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            max-height: 90vh;
            overflow-y: auto;
            margin: 40px auto;
            transition: all 0.3s;
        }

        .color-customizer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gray);
        }

        .color-customizer-title {
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: 700;
        }

        .color-customizer-close {
            color: var(--text-muted);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .color-customizer-close:hover {
            color: var(--light);
        }

        .color-picker-group {
            margin-bottom: 20px;
        }

        .color-picker-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text);
            font-size: 0.95rem;
        }

        .color-picker {
            width: 100%;
            height: 40px;
            border-radius: 5px;
            cursor: pointer;
            background: var(--gray);
            border: 1px solid var(--text-muted);
        }

        .customizer-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .customizer-btn {
            padding: 10px 20px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .apply-btn {
            background: var(--primary);
            color: var(--background);
        }

        .apply-btn:hover {
            background: var(--accent);
        }

        .cancel-btn {
            background: var(--gray);
            color: var(--text);
            border: 1px solid var(--text-muted);
        }

        .cancel-btn:hover {
            background: var(--secondary);
            color: var(--light);
        }

        @media (max-width: 768px) {
            .scenario-description {
                flex-direction: column;
            }

            h1 {
                font-size: 2.2rem;
            }

            .modal-content {
                width: 95%;
                margin: 10% auto;
            }

            .parameter-row {
                flex-direction: column;
                align-items: flex-start;
            }

            .parameter-label {
                width: 100%;
                margin-bottom: 5px;
            }

            .theme-palette {
                bottom: 20px;
                right: 20px;
            }

            .palette-button {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
        }

        /* –î–ª—è —Ç–µ–º—ã —Ç–µ–º–Ω–æ–≥–æ —Ñ–æ–Ω–∞ (—Ñ–∏–æ–ª–µ—Ç–æ–≤–∞—è) */
        .theme-dark {
            --primary: #8e83f2;
            --accent: #c33eeb;
            --background: #010109;
            --text: #e4e3fc;
            --card-bg: #121222;
            --bad-value: #ff6b8b;
            /* —Ä–æ–∑–æ–≤—ã–π –¥–ª—è –æ—à–∏–±–æ–∫ */
            --good-value: #6ddea7;
            /* –º—è—Ç–Ω—ã–π –¥–ª—è —É—Å–ø–µ—Ö–∞ */
        }

        /* –î–ª—è —Å–∏–Ω–µ–π —Ç–µ–º—ã */
        .theme-blue {
            --primary: #5db5f6;
            --accent: #3d8bfd;
            --background: #00121a;
            --text: #dceefc;
            --card-bg: #0a1c2a;
            --bad-value: #ff9b5c;
            /* –ø–µ—Ä—Å–∏–∫–æ–≤—ã–π */
            --good-value: #5cd6b4;
            /* –±–∏—Ä—é–∑–æ–≤—ã–π */
        }

        /* –î–ª—è –∫—Ä–∞—Å–Ω–æ–π —Ç–µ–º—ã */
        .theme-red {
            --primary: #ff6b6b;
            --accent: #ff8e8e;
            --background: #1a0000;
            --text: #ffdfdf;
            --card-bg: #2a0000;
            --bad-value: #ff9b5c;
            /* –ø–µ—Ä—Å–∏–∫–æ–≤—ã–π */
            --good-value: #a8e6a0;
            /* —Å–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π */
        }

        /* –î–ª—è –∑–µ–ª–µ–Ω–æ–π —Ç–µ–º—ã */
        .theme-green {
            --primary: #60d394;
            --accent: #3acf7a;
            --background: #002a1e;
            --text: #dcfcee;
            --card-bg: #0a3326;
            --bad-value: #ff8a65;
            /* –∫–æ—Ä–∞–ª–ª–æ–≤—ã–π */
            --good-value: #3fb1b0;
            /* –±–∏—Ä—é–∑–æ–≤—ã–π */
        }

        /* –î–ª—è —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–π —Ç–µ–º—ã */
        .theme-yellow {
            --primary: #ffd700;
            /* –Ø—Ä–∫–æ-–∑–æ–ª–æ—Ç–æ–π (–æ—Å–Ω–æ–≤–Ω–æ–π) */
            --accent: #f2a900;
            /* –¢–µ–ø–ª—ã–π —è–Ω—Ç–∞—Ä–Ω—ã–π */
            --background: #121212;
            /* –¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π, –ø–æ—á—Ç–∏ —á–µ—Ä–Ω—ã–π */
            --text: #fffbea;
            /* –ú—è–≥–∫–∏–π –∫—Ä–µ–º–æ–≤–æ-–±–µ–ª—ã–π */
            --card-bg: #1e1e1e;
            /* –¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
            --bad-value: #ff7b42;
            /* –Ø—Ä–∫–æ-–∫—Ä–∞—Å–Ω—ã–π –¥–ª—è –æ—à–∏–±–æ–∫ */
            --good-value: #a1d743;
            /* –õ–∞–π–º–æ–≤–æ-–∑–µ–ª–µ–Ω—ã–π –¥–ª—è —É—Å–ø–µ—Ö–∞ */
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <header>
            <h1>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</h1>
            <p class="subtitle">–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –±—ã—Ç—å –∑–¥–æ—Ä–æ–≤–æ–π, –±–æ–≥–∞—Ç–æ–π –∏ —Å—á–∞—Å—Ç–ª–∏–≤–æ–π –≤ —Ä–∞–∑–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö (2025-2040)</p>
        </header>

        <button class="params-btn" onclick="openModal('parameters-modal')">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è</button>

        <table class="comparison-table">
            <thead>
                <tr>
                    <th>–ö—Ä–∏—Ç–µ—Ä–∏–π</th>
                    <th>–¢–≤–æ—è –∂–∏–∑–Ω—å —Å–µ–π—á–∞—Å</th>
                    <th>–§—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>–§–∏–Ω–∞–Ω—Å—ã ($1M)</strong><br>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞–∫–æ–ø–∏—Ç—å $1 –º–ª–Ω –∫ 2040 –≥–æ–¥—É</td>
                    <td>
                        <div class="probability-value bad-value" id="current-money">0%</div>
                        <button class="details-btn" onclick="openModal('money-current')">–ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞—Å—á–µ—Ç</button>
                    </td>
                    <td>
                        <div class="probability-value good-value" id="it-money">86.7%</div>
                        <button class="details-btn" onclick="openModal('money-it')">–ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞—Å—á–µ—Ç</button>
                    </td>
                </tr>
                <tr>
                    <td><strong>–ó–¥–æ—Ä–æ–≤—å–µ</strong><br>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ</td>
                    <td>
                        <div class="probability-value bad-value" id="current-health">0.000107%</div>
                        <button class="details-btn" onclick="openModal('health-current')">–ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞—Å—á–µ—Ç</button>
                    </td>
                    <td>
                        <div class="probability-value good-value" id="it-health">38.64%</div>
                        <button class="details-btn" onclick="openModal('health-it')">–ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞—Å—á–µ—Ç</button>
                    </td>
                </tr>
                <tr>
                    <td><strong>–°—á–∞—Å—Ç—å–µ</strong><br>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±—ã—Ç—å —Å—á–∞—Å—Ç–ª–∏–≤–æ–π</td>
                    <td>
                        <div class="probability-value bad-value" id="current-happy">29.32%</div>
                        <button class="details-btn" onclick="openModal('happy-current')">–ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞—Å—á–µ—Ç</button>
                    </td>
                    <td>
                        <div class="probability-value good-value" id="it-happy">86.5%</div>
                        <button class="details-btn" onclick="openModal('happy-it')">–ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞—Å—á–µ—Ç</button>
                    </td>
                </tr>
                <tr>
                    <td><strong>–ü–æ–ª–Ω—ã–π —É—Å–ø–µ—Ö</strong><br>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±—ã—Ç—å –∑–¥–æ—Ä–æ–≤–æ–π, –±–æ–≥–∞—Ç–æ–π –∏ —Å—á–∞—Å—Ç–ª–∏–≤–æ–π</td>
                    <td>
                        <div class="probability-value bad-value" id="current-success">0%</div>
                        <button class="details-btn" onclick="openModal('success-current')">–ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞—Å—á–µ—Ç</button>
                    </td>
                    <td>
                        <div class="probability-value good-value" id="it-success">28.64%</div>
                        <button class="details-btn" onclick="openModal('success-it')">–ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞—Å—á–µ—Ç</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –ø–∞–ª–∏—Ç—Ä—ã –∏ —Ü–≤–µ—Ç–æ–≤—ã–µ –æ–ø—Ü–∏–∏ -->
    <div class="theme-palette">
        <button class="palette-button" onclick="toggleColorOptions()">üé®</button>
        <div class="color-options" id="colorOptions">
            <div class="color-option" style="background: #8e83f2;" onclick="applyTheme('theme-dark')"></div>
            <div class="color-option" style="background: #5db5f6;" onclick="applyTheme('theme-blue')"></div>
            <div class="color-option" style="background: #f0503f;" onclick="applyTheme('theme-red')"></div>
            <div class="color-option" style="background: #ffd700;" onclick="applyTheme('theme-yellow')"></div>
            <div class="color-option" style="background: #28a745;" onclick="applyTheme('theme-green')"></div>
            <div class="color-option" style="background: #ffffff;" onclick="openColorCustomizer()">‚úèÔ∏è</div>
        </div>
    </div>

    <!-- –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ç–æ—Ä —Ü–≤–µ—Ç–æ–≤ -->
    <div class="color-customizer" id="colorCustomizer">
        <div class="color-customizer-content">
            <div class="color-customizer-header">
                <h3 class="color-customizer-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤</h3>
                <span class="color-customizer-close" onclick="closeColorCustomizer()">&times;</span>
            </div>

            <div class="color-picker-group">
                <label class="color-picker-label">–û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç:</label>
                <input type="color" class="color-picker" id="primaryColor" value="#8e83f2">
            </div>

            <div class="color-picker-group">
                <label class="color-picker-label">–ê–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç:</label>
                <input type="color" class="color-picker" id="accentColor" value="#c33eeb">
            </div>

            <div class="color-picker-group">
                <label class="color-picker-label">–§–æ–Ω:</label>
                <input type="color" class="color-picker" id="bgColor" value="#010109">
            </div>

            <div class="color-picker-group">
                <label class="color-picker-label">–¢–µ–∫—Å—Ç:</label>
                <input type="color" class="color-picker" id="textColor" value="#e4e3fc">
            </div>

            <div class="color-picker-group">
                <label class="color-picker-label">–ö–∞—Ä—Ç–æ—á–∫–∏:</label>
                <input type="color" class="color-picker" id="cardColor" value="#121222">
            </div>

            <div class="color-picker-group">
                <label class="color-picker-label">–¶–≤–µ—Ç –Ω–µ—É–¥–∞—á:</label>
                <input type="color" class="color-picker" id="badColor" value="#ff6b8b">
            </div>

            <div class="color-picker-group">
                <label class="color-picker-label">–¶–≤–µ—Ç —É—Å–ø–µ—Ö–∞:</label>
                <input type="color" class="color-picker" id="goodColor" value="#6ddea7">
            </div>

            <div class="customizer-buttons">
                <button class="customizer-btn cancel-btn" onclick="closeColorCustomizer()">–û—Ç–º–µ–Ω–∞</button>
                <button class="customizer-btn apply-btn" onclick="applyCustomTheme()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ -->
    <div id="parameters-modal" class="modal">
        <div class="modal-content">
            <!-- <div class="modal-header">
                <h3 class="modal-title">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                <span class="close" onclick="closeModal('parameters-modal')">&times;</span>
            </div> -->
            <div class="parameter-controls">

                <div class="parameter-group">
                    <div class="parameter-row">
                        <div class="parameter-label">–ü–µ—Ä–∏–æ–¥ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è (–ª–µ—Ç):</div>
                        <div class="parameter-value">
                            <input type="number" id="years" value="15" min="1" max="50">
                        </div>
                    </div>
                </div>

                <div class="parameter-group">
                    <div class="parameter-row">
                        <div class="parameter-label">–°—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:</div>
                        <div class="parameter-value">
                            <select id="current-job-type">
                                <option value="office">–û—Ñ–∏—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –º–µ–Ω–µ–¥–∂–µ—Ä)</option>
                                <option value="physical">–§–∏–∑–∏—á–µ—Å–∫–∏–π —Ç—Ä—É–¥ (—Å—Ç—Ä–æ–∏—Ç–µ–ª—å, –≥—Ä—É–∑—á–∏–∫)</option>
                                <option value="creative">–¢–≤–æ—Ä—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ (–¥–∏–∑–∞–π–Ω–µ—Ä, –ø–∏—Å–∞—Ç–µ–ª—å)</option>
                                <option value="it">IT-—Å—Ñ–µ—Ä–∞ (—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫)</option>
                                <option value="medical">–ú–µ–¥–∏—Ü–∏–Ω–∞ (–≤—Ä–∞—á, –º–µ–¥—Å–µ—Å—Ç—Ä–∞)</option>
                                <option value="education" selected>–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (—É—á–∏—Ç–µ–ª—å, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å)</option>
                                <option value="sales">–ü—Ä–æ–¥–∞–∂–∏ (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º)</option>
                                <option value="service">–°—Ñ–µ—Ä–∞ —É—Å–ª—É–≥ (–ø–∞—Ä–∏–∫–º–∞—Ö–µ—Ä, –∫–æ—Å–º–µ—Ç–æ–ª–æ–≥)</option>
                                <option value="finance">–§–∏–Ω–∞–Ω—Å—ã (–±—É—Ö–≥–∞–ª—Ç–µ—Ä, –∞–Ω–∞–ª–∏—Ç–∏–∫)</option>
                                <option value="freelance">–§—Ä–∏–ª–∞–Ω—Å (—Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã)</option>
                                <option value="unemployed">–ë–µ–∑—Ä–∞–±–æ—Ç–Ω—ã–π</option>
                            </select>
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–î–æ—Ö–æ–¥ (‚ÇΩ/–º–µ—Å):</div>
                        <div class="parameter-value">
                            <input type="number" id="current-income" value="35000" min="0">
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–†–∞—Å—Ö–æ–¥—ã (‚ÇΩ/–º–µ—Å):</div>
                        <div class="parameter-value">
                            <input type="number" id="current-expenses" value="32500" min="0">
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–ù–∞–∫–æ–ø–ª–µ–Ω–∏—è (‚ÇΩ):</div>
                        <div class="parameter-value">
                            <input type="number" id="current-savings" value="0" min="0">
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π (% –≥–æ–¥–æ–≤—ã—Ö):</div>
                        <div class="parameter-value">
                            <input type="number" id="current-investment" value="10" step="0.1" min="0" max="10"
                                readonly>
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–π:</div>
                        <div class="parameter-value">
                            <select id="current-children">
                                <option value="0">–ù–µ—Ç –¥–µ—Ç–µ–π</option>
                                <option value="1">1 —Ä–µ–±–µ–Ω–æ–∫</option>
                                <option value="2">2 —Ä–µ–±–µ–Ω–∫–∞</option>
                                <option value="3">3 –∏ –±–æ–ª–µ–µ –¥–µ—Ç–µ–π</option>
                            </select>
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–û—Ç–Ω–æ—à–µ–Ω–∏—è:</div>
                        <div class="parameter-value">
                            <select id="current-relationship-status">
                                <option value="0" selected>–ù–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö</option>
                                <option value="7">–í –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö</option>
                            </select>
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏ (1-10):</div>
                        <div class="parameter-value">
                            <input type="number" id="current-relationship" value="5" min="1" max="10">
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–£—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞ (1-10):</div>
                        <div class="parameter-value">
                            <input type="number" id="current-stress" value="5" min="1" max="10">
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–ö–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞ (1-10):</div>
                        <div class="parameter-value">
                            <input type="number" id="current-sleep" value="5" min="1" max="10">
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–§–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (—á–∞—Å–æ–≤/–Ω–µ–¥–µ–ª—é):</div>
                        <div class="parameter-value">
                            <input type="number" id="current-activity" value="3" min="0" max="40">
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–í—Ä–µ–¥–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏:</div>
                        <div class="parameter-value">
                            <select id="current-bad-habits">
                                <option value="0">–ù–µ—Ç</option>
                                <option value="1">–ö—É—Ä–µ–Ω–∏–µ</option>
                                <option value="2">–ê–ª–∫–æ–≥–æ–ª—å</option>
                                <option value="3">–î—Ä—É–≥–æ–µ</option>
                            </select>
                        </div>
                    </div>
                    <div class="parameter-row">
                        <div class="parameter-label">–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–æ–π (1-10):</div>
                        <div class="parameter-value">
                            <input type="number" id="current-job-satisfaction" value="3" min="1" max="10">
                        </div>
                    </div>
                </div>

                <button class="update-btn" onclick="updateCalculations(); closeModal('parameters-modal')">–û–±–Ω–æ–≤–∏—Ç—å
                    —Ä–∞—Å—á—ë—Ç—ã</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ —Å —Ä–∞—Å—á–µ—Ç–∞–º–∏ -->
    <div id="money-current" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–§–∏–Ω–∞–Ω—Å—ã: –¢–≤–æ—è –∂–∏–∑–Ω—å —Å–µ–π—á–∞—Å</h3>
                <span class="close" onclick="closeModal('money-current')">&times;</span>
            </div>
            <div class="calculation-steps" id="money-current-calculation">
                <!-- Content will be generated dynamically -->
            </div>
        </div>
    </div>

    <div id="money-it" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–§–∏–Ω–∞–Ω—Å—ã: –§—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</h3>
                <span class="close" onclick="closeModal('money-it')">&times;</span>
            </div>
            <div class="calculation-steps" id="money-it-calculation">
                <!-- Content will be generated dynamically -->
            </div>
        </div>
    </div>

    <div id="health-current" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–ó–¥–æ—Ä–æ–≤—å–µ: –¢–≤–æ—è –∂–∏–∑–Ω—å —Å–µ–π—á–∞—Å</h3>
                <span class="close" onclick="closeModal('health-current')">&times;</span>
            </div>
            <div class="calculation-steps" id="health-current-calculation">
                <!-- Content will be generated dynamically -->
            </div>
        </div>
    </div>

    <div id="health-it" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–ó–¥–æ—Ä–æ–≤—å–µ: –§—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</h3>
                <span class="close" onclick="closeModal('health-it')">&times;</span>
            </div>
            <div class="calculation-steps" id="health-it-calculation">
                <!-- Content will be generated dynamically -->
            </div>
        </div>
    </div>

    <div id="happy-current" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–°—á–∞—Å—Ç—å–µ: –¢–≤–æ—è –∂–∏–∑–Ω—å —Å–µ–π—á–∞—Å</h3>
                <span class="close" onclick="closeModal('happy-current')">&times;</span>
            </div>
            <div class="calculation-steps" id="happy-current-calculation">
                <!-- Content will be generated dynamically -->
            </div>
        </div>
    </div>

    <div id="happy-it" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–°—á–∞—Å—Ç—å–µ: –§—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</h3>
                <span class="close" onclick="closeModal('happy-it')">&times;</span>
            </div>
            <div class="calculation-steps" id="happy-it-calculation">
                <!-- Content will be generated dynamically -->
            </div>
        </div>
    </div>

    <div id="success-current" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–ü–æ–ª–Ω—ã–π —É—Å–ø–µ—Ö: –¢–≤–æ—è –∂–∏–∑–Ω—å —Å–µ–π—á–∞—Å</h3>
                <span class="close" onclick="closeModal('success-current')">&times;</span>
            </div>
            <div class="calculation-steps" id="success-current-calculation">
                <!-- Content will be generated dynamically -->
            </div>
        </div>
    </div>

    <div id="success-it" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–ü–æ–ª–Ω—ã–π —É—Å–ø–µ—Ö: –§—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</h3>
                <span class="close" onclick="closeModal('success-it')">&times;</span>
            </div>
            <div class="calculation-steps" id="success-it-calculation">
                <!-- Content will be generated dynamically -->
            </div>
        </div>
    </div>

    <script>
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
        function openModal(id) {
            document.getElementById(id).style.display = 'block';
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –æ–∫–Ω–∞
        window.onclick = function (event) {
            if (event.target.className === 'modal') {
                event.target.style.display = 'none';
            }
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª
        function formatPercent(value) {
            if (value < 0.0001) {
                // –î–ª—è –æ—á–µ–Ω—å –º–∞–ª—ã—Ö —á–∏—Å–µ–ª —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä—É—á–Ω—É—é
                const fixedValue = value.toFixed(8); // –§–∏–∫—Å–∏—Ä—É–µ–º 8 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
                return parseFloat(fixedValue).toString() + '%'; // –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –Ω—É–ª–∏
            } else if (value < 1) {
                return value.toFixed(4) + '%'; // 4 –∑–Ω–∞–∫–∞ –¥–ª—è –º–∞–ª—ã—Ö –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
            } else {
                return value.toFixed(2) + '%'; // 2 –∑–Ω–∞–∫–∞ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
            }
        }

        function formatMoney(value) {
            return '$' + value.toLocaleString('en-US', { maximumFractionDigits: 0 });
        }

        // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –æ—Ç–Ω–æ—à–µ–Ω–∏–π
        document.getElementById('current-relationship-status').addEventListener('change', function () {
            const relationshipInput = document.getElementById('current-relationship');
            if (this.value === '0') {
                relationshipInput.disabled = true;
                relationshipInput.value = '1';
            } else {
                relationshipInput.disabled = false;
                relationshipInput.value = this.value;
            }
        });

        // –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã
        function calculateCurrentMoney() {
            const income = parseFloat(document.getElementById('current-income').value);
            const expenses = parseFloat(document.getElementById('current-expenses').value);
            const savings = parseFloat(document.getElementById('current-savings').value);
            const investmentReturn = 0.10; // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ 10%
            const years = parseFloat(document.getElementById('years').value);
            const children = parseInt(document.getElementById('current-children').value);

            // –ù–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç –≤–ª–∏—è–Ω–∏—è –¥–µ—Ç–µ–π –Ω–∞ —Ä–∞—Å—Ö–æ–¥—ã (15% –Ω–∞ —Ä–µ–±–µ–Ω–∫–∞)
            const childrenFactor = 1 + (children * 0.15);
            const adjustedExpenses = expenses * childrenFactor;

            const savingsPerMonth = income - adjustedExpenses;
            const savingsPerYear = savingsPerMonth * 12 / 73; // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è RUB –≤ USD

            if (savingsPerYear <= 0) return 0;

            // –†–∞—Å—á–µ—Ç –±—É–¥—É—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏
            const futureValue = savings / 73 + savingsPerYear * ((Math.pow(1 + investmentReturn, years) - 1) / investmentReturn);

            // –†–∞—Å—á–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è $1M
            let probability;
            if (futureValue >= 1000000) {
                probability = 100;
            } else if (futureValue >= 500000) {
                probability = (futureValue / 1000000) * 50; // –î–æ 50% –ø—Ä–∏ $500K‚Äì$1M
            } else {
                probability = (futureValue / 1000000) * 10; // < 5% –¥–ª—è —Å—É–º–º < $500K
            }
            probability = Math.min(100, probability.toFixed(2));

            // Generate calculation steps for modal
            let calculationHTML = `
                <div class="calculation-step">

                    <ul>
                        <li>–î–æ—Ö–æ–¥: ${income.toLocaleString('ru-RU')} ‚ÇΩ/–º–µ—Å ($${(income / 73).toFixed(0)})</li>
                        <li>–†–∞—Å—Ö–æ–¥—ã: ${expenses.toLocaleString('ru-RU')} ‚ÇΩ/–º–µ—Å (–±–∞–∑–æ–≤—ã–µ)</li>
                        <li>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–π: ${children} (${children > 0 ? '—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ ' + (children * 30) + '%' : '–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å—Ö–æ–¥—ã'})</li>
                        <li>–°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã: ${adjustedExpenses.toLocaleString('ru-RU')} ‚ÇΩ/–º–µ—Å ($${(adjustedExpenses / 73).toFixed(0)})</li>
                        <li>–°–±–µ—Ä–µ–∂–µ–Ω–∏—è: ${savings.toLocaleString('ru-RU')} ‚ÇΩ ($${(savings / 73).toFixed(0)})</li>
                        <li>–°–±–µ—Ä–µ–∂–µ–Ω–∏—è –≤ –º–µ—Å—è—Ü: ${savingsPerMonth.toLocaleString('ru-RU')} ‚ÇΩ ($${(savingsPerMonth / 73).toFixed(0)})</li>
                        <li>–ü–µ—Ä–∏–æ–¥: ${years} –ª–µ—Ç</li>
                        <li>–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π: ${(investmentReturn * 100).toFixed(1)}% –≥–æ–¥–æ–≤—ã—Ö</li>
                    </ul>
                </div>
                
                <div class="calculation-step">
                    <h4>–†–∞—Å—á—ë—Ç:</h4>
                    <div class="calculation-formula">
                        –ì–æ–¥–æ–≤—ã–µ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è: $${(savingsPerMonth / 73).toFixed(0)} √ó 12 = $${savingsPerYear.toFixed(0)}<br><br>
                        
                        –ë—É–¥—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:<br>
                        FV = –ù–∞–∫–æ–ø–ª–µ–Ω–∏—è + –ê–Ω–Ω—É–∏—Ç–µ—Ç<br>
                        = $${(savings / 73).toFixed(0)} + $${savingsPerYear.toFixed(0)} √ó [(1+${investmentReturn.toFixed(4)})^${years} - 1)/${investmentReturn.toFixed(4)}]<br>
                        ‚âà ${formatMoney(futureValue)}
                    </div>
                </div>
                
                <div class="calculation-step">
                    <h4>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏:</h4>
                    <div class="calculation-formula">
                        P(–Ω–∞–∫–æ–ø–∏—Ç—å $1M) = ${probability.toFixed(1)}%
                    </div>
                    <p>–í—ã–≤–æ–¥: ${probability >= 50 ? '—É–º–µ—Ä–µ–Ω–Ω–∞—è' : '–Ω–∏–∑–∫–∞—è'} –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏—á—å —Ü–µ–ª–∏ $1 –º–ª–Ω –ø—Ä–∏ —Ç–µ–∫—É—â–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö.</p>
                    ${children > 0 ? '<p>–ù–∞–ª–∏—á–∏–µ –¥–µ—Ç–µ–π –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π.</p>' : ''}
                </div>
            `;

            document.getElementById('money-current-calculation').innerHTML = calculationHTML;

            return probability;
        }

        function calculateITMoney() {
            // Fixed parameters for IT scenario
            const income = 225000;
            const expenses = 50000;
            const investmentReturn = 0.10; // 10% –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è IT
            const careerGrowthProb = 0.60;
            const jobLossRisk = 0.10;
            const years = parseFloat(document.getElementById('years').value);

            const savingsPerMonth = income - expenses;
            const savingsPerYear = savingsPerMonth * 12 / 73; // Convert RUB to USD (approximate)

            // Base calculation without career growth
            let futureValue = savingsPerYear * (Math.pow(1 + investmentReturn, years) - 1) / investmentReturn;

            // Adjust for career growth (50% increase after 5 years with 60% probability)
            const growthFactor = Math.pow(1.5, careerGrowthProb);
            futureValue *= growthFactor;

            // Adjust for job loss risk
            futureValue *= (1 - jobLossRisk);

            // Calculate probability to reach $1M
            let probability = 0;
            if (futureValue >= 1000000) {
                probability = 100;
            } else if (futureValue >= 800000) {
                probability = 80 + (futureValue - 800000) / 10000;
            } else if (futureValue >= 500000) {
                probability = 50 + (futureValue - 500000) / 10000;
            } else {
                probability = futureValue / 10000;
            }

            probability = Math.min(100, probability);

            // Generate calculation steps for modal
            let calculationHTML = `
                <div class="calculation-step">

                    <ul>
                        <li>–î–æ—Ö–æ–¥: ${income.toLocaleString('ru-RU')} ‚ÇΩ/–º–µ—Å ($${(income / 73).toFixed(0)}) (–º–∏–¥–ª-–ø–æ–∑–∏—Ü–∏—è + –≤—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞)</li>
                        <li>–†–∞—Å—Ö–æ–¥—ã: ${expenses.toLocaleString('ru-RU')} ‚ÇΩ/–º–µ—Å ($${(expenses / 73).toFixed(0)})</li>
                        <li>–°–±–µ—Ä–µ–∂–µ–Ω–∏—è: ${savingsPerMonth.toLocaleString('ru-RU')} ‚ÇΩ/–º–µ—Å ($${(savingsPerMonth / 73).toFixed(0)})</li>
                        <li>–ü–µ—Ä–∏–æ–¥: ${years} –ª–µ—Ç</li>
                        <li>–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π: ${(investmentReturn * 100).toFixed(1)}% –≥–æ–¥–æ–≤—ã—Ö</li>
                        <li>–ö–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç: +50% –¥–æ—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ 5 –ª–µ—Ç (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å ${(careerGrowthProb * 100).toFixed(1)}%)</li>
                        <li>–†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ —Ä–∞–±–æ—Ç—ã: ${(jobLossRisk * 100).toFixed(1)}% –∑–∞ ${years} –ª–µ—Ç</li>
                    </ul>
                </div>
                
                <div class="calculation-step">
                    <h4>–ë–∞–∑–æ–≤—ã–π —Ä–∞—Å—á—ë—Ç:</h4>
                    <div class="calculation-formula">
                        –ì–æ–¥–æ–≤—ã–µ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è: $${(savingsPerMonth / 73).toFixed(0)} √ó 12 = $${savingsPerYear.toFixed(0)}<br><br>
                        
                        –ë—É–¥—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞–Ω–Ω—É–∏—Ç–µ—Ç–∞:<br>
                        FV = ${savingsPerYear.toFixed(0)} √ó [(1+${investmentReturn.toFixed(4)})^${years} - 1)/${investmentReturn.toFixed(4)}] ‚âà ${formatMoney(savingsPerYear * (Math.pow(1 + investmentReturn, years) - 1) / investmentReturn)}
                    </div>
                </div>
                
                <div class="calculation-step">
                    <h4>–° —É—á—ë—Ç–æ–º —Ñ–∞–∫—Ç–æ—Ä–æ–≤:</h4>
                    <div class="calculation-formula">
                        –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞:<br>
                        ${formatMoney(savingsPerYear * (Math.pow(1 + investmentReturn, years) - 1) / investmentReturn)} √ó ${growthFactor.toFixed(2)} √ó ${(1 - jobLossRisk).toFixed(2)} ‚âà ${formatMoney(futureValue)}<br>
                        (–∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç √ó —Ä–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ —Ä–∞–±–æ—Ç—ã)
                    </div>
                </div>
                
                <div class="calculation-step">
                    <h4>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏:</h4>
                    <div class="calculation-formula">
                        P(–Ω–∞–∫–æ–ø–∏—Ç—å $1M) = ${probability.toFixed(1)}%
                    </div>
                    <p>–í—ã–≤–æ–¥: –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏—á—å —Ü–µ–ª–∏ $1 –º–ª–Ω –±–ª–∞–≥–æ–¥–∞—Ä—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–º—É –¥–æ—Ö–æ–¥—É –∏ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ —Ä–∞—Å—Ö–æ–¥–∞–º–∏.</p>
                </div>
            `;

            document.getElementById('money-it-calculation').innerHTML = calculationHTML;

            return probability;
        }

        function calculateCurrentHealth() {
            const stressLevel = parseFloat(document.getElementById('current-stress').value) / 10;
            const sleepQuality = parseFloat(document.getElementById('current-sleep').value) / 10;
            const activityHours = parseFloat(document.getElementById('current-activity').value);
            const children = parseInt(document.getElementById('current-children').value);
            const years = parseFloat(document.getElementById('years').value);
            const jobType = document.getElementById('current-job-type').value;
            const badHabits = document.getElementById('current-bad-habits').value;

            // Base illness rate based on stress and sleep
            let illnessesPerYear = 3 + (1 - sleepQuality) * 5 + stressLevel * 4;

            // Adjust for children
            illnessesPerYear += children * 2;

            // Adjust for job type
            switch (jobType) {
                case 'office':
                    illnessesPerYear += 2; // –°–∏–¥—è—á–∞—è —Ä–∞–±–æ—Ç–∞
                    break;
                case 'physical':
                    illnessesPerYear += 4; // –§–∏–∑–∏—á–µ—Å–∫–∏–π —Ç—Ä—É–¥ - –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ —Ç—Ä–∞–≤–º
                    break;
                case 'creative':
                    illnessesPerYear += 1; // –¢–≤–æ—Ä—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ - —Å—Ä–µ–¥–Ω–∏–π —Å—Ç—Ä–µ—Å—Å
                    break;
                case 'it':
                    illnessesPerYear += 1; // IT - —Å–∏–¥—è—á–∞—è, –Ω–æ –≥–∏–±–∫–∏–µ —É—Å–ª–æ–≤–∏—è
                    break;
                case 'medical':
                    illnessesPerYear += 5; // –ú–µ–¥–∏—Ü–∏–Ω–∞ - –≤—ã—Å–æ–∫–∏–π —Å—Ç—Ä–µ—Å—Å –∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏
                    break;
                case 'education':
                    illnessesPerYear += 3; // –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ - —Å—Ç—Ä–µ—Å—Å + –∫–æ–Ω—Ç–∞–∫—Ç—ã —Å –ª—é–¥—å–º–∏
                    break;
                case 'sales':
                    illnessesPerYear += 2; // –ü—Ä–æ–¥–∞–∂–∏ - —Å—Ä–µ–¥–Ω–∏–π —Å—Ç—Ä–µ—Å—Å
                    break;
                case 'service':
                    illnessesPerYear += 2; // –°—Ñ–µ—Ä–∞ —É—Å–ª—É–≥ - —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                    break;
                case 'finance':
                    illnessesPerYear += 3; // –§–∏–Ω–∞–Ω—Å—ã - –≤—ã—Å–æ–∫–∏–π —Å—Ç—Ä–µ—Å—Å
                    break;
                case 'freelance':
                    illnessesPerYear += 2; // –§—Ä–∏–ª–∞–Ω—Å - –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                    break;
                case 'unemployed':
                    illnessesPerYear += 4; // –ë–µ–∑—Ä–∞–±–æ—Ç–∏—Ü–∞ - —Å—Ç—Ä–µ—Å—Å + –≤–æ–∑–º–æ–∂–Ω–æ –ø–ª–æ—Ö–∏–µ —É—Å–ª–æ–≤–∏—è
                    break;
                default:
                    illnessesPerYear += 1;
            }

            // Adjust for bad habits
            if (badHabits !== '0') {
                illnessesPerYear += 3;
            }

            // Fixed complication risk (5%)
            const complicationRisk = 0.05;
            const totalIllnesses = illnessesPerYear * years;
            const pNoComplications = Math.pow(1 - complicationRisk, totalIllnesses);

            // Calculate health factors
            const stressImpact = stressLevel * 0.4;
            const sleepImpact = (1 - sleepQuality) * 0.3;
            const activityImpact = (1 - Math.min(1, activityHours / 10)) * 0.2;
            const childrenImpact = children > 0 ? 0.1 : 0;
            const jobImpact = jobType === 'office' || jobType === 'it' ? 0.1 : 0.15;
            const habitsImpact = badHabits !== '0' ? 0.15 : 0;

            const totalRisk = stressImpact + sleepImpact + activityImpact + childrenImpact + jobImpact + habitsImpact;
            const pNoLifestyleIssues = 1 - totalRisk;

            // Final probability
            const pHealth = pNoComplications * pNoLifestyleIssues;

            // Generate calculation steps for modal
            let calculationHTML = `
                <div class="calculation-step">
                    <ul>
                        <li>–£—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞: ${stressLevel * 10}/10</li>
                        <li>–ö–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞: ${sleepQuality * 10}/10</li>
                        <li>–§–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${activityHours} —á–∞—Å–æ–≤/–Ω–µ–¥–µ–ª—é</li>
                        <li>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–π: ${children}</li>
                        <li>–°—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: ${document.getElementById('current-job-type').options[document.getElementById('current-job-type').selectedIndex].text}</li>
                        <li>–í—Ä–µ–¥–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏: ${badHabits !== '0' ? '–î–∞' : '–ù–µ—Ç'}</li>
                        <li>–ü–µ—Ä–∏–æ–¥: ${years} –ª–µ—Ç</li>
                    </ul>
                </div>
                
                <div class="calculation-step">
                    <h4>–†–∞—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–æ–ª–µ–∑–Ω–µ–π:</h4>
                    <div class="calculation-formula">
                        –ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å: 3 –±–æ–ª–µ–∑–Ω–∏/–≥–æ–¥ 
                        + ${((1 - sleepQuality) * 5).toFixed(1)} –∏–∑-–∑–∞ –ø–ª–æ—Ö–æ–≥–æ —Å–Ω–∞
                        + ${(stressLevel * 4).toFixed(1)} –∏–∑-–∑–∞ —Å—Ç—Ä–µ—Å—Å–∞
                        + ${(children * 2).toFixed(1)} –∏–∑-–∑–∞ –¥–µ—Ç–µ–π
                        + ${jobType === 'office' ? 2 : jobType === 'physical' ? 3 : jobType === 'medical' ? 4 : jobType === 'it' ? 1 : 1} –∏–∑-–∑–∞ —Ä–∞–±–æ—Ç—ã
                        ${badHabits !== '0' ? '+ 3 –∏–∑-–∑–∞ –≤—Ä–µ–¥–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫' : ''}
                        = ${illnessesPerYear.toFixed(1)} –±–æ–ª–µ–∑–Ω–µ–π/–≥–æ–¥<br>
                        
                        –í—Å–µ–≥–æ –±–æ–ª–µ–∑–Ω–µ–π –∑–∞ ${years} –ª–µ—Ç: ${illnessesPerYear.toFixed(1)} √ó ${years} ‚âà ${totalIllnesses.toFixed(0)}
                    </div>
                </div>
                
                <div class="calculation-step">
                    <h4>–†–∞—Å—á—ë—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∏–∑–±–µ–∂–∞—Ç—å –æ—Å–ª–æ–∂–Ω–µ–Ω–∏–π:</h4>
                    <div class="calculation-formula">
                        –†–∏—Å–∫ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏–π: 5% –Ω–∞ –±–æ–ª–µ–∑–Ω—å<br>
                        P(–±–µ–∑ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏–π) = 0.95^${totalIllnesses.toFixed(0)} ‚âà ${pNoComplications.toFixed(4)} (${(pNoComplications * 100).toFixed(2)}%)
                    </div>
                </div>
                
                <div class="calculation-step">
                    <h4>–†–∞—Å—á—ë—Ç —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏:</h4>
                    <div class="calculation-formula">
                        –í–ª–∏—è–Ω–∏–µ —Å—Ç—Ä–µ—Å—Å–∞: ${(stressLevel * 100).toFixed(1)}% √ó 40% = ${(stressImpact * 100).toFixed(1)}%<br>
                        –í–ª–∏—è–Ω–∏–µ –ø–ª–æ—Ö–æ–≥–æ —Å–Ω–∞: ${((1 - sleepQuality) * 100).toFixed(1)}% √ó 30% = ${(sleepImpact * 100).toFixed(1)}%<br>
                        –í–ª–∏—è–Ω–∏–µ –Ω–∏–∑–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: ${((1 - Math.min(1, activityHours / 10)) * 100).toFixed(1)}% √ó 20% = ${(activityImpact * 100).toFixed(1)}%<br>
                        –í–ª–∏—è–Ω–∏–µ –¥–µ—Ç–µ–π: ${(childrenImpact * 100).toFixed(1)}%<br>
                        –í–ª–∏—è–Ω–∏–µ —Ä–∞–±–æ—Ç—ã: ${(jobImpact * 100).toFixed(1)}%<br>
                        ${badHabits !== '0' ? '–í–ª–∏—è–Ω–∏–µ –≤—Ä–µ–¥–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫: ' + (habitsImpact * 100).toFixed(1) + '%<br>' : ''}
                        
                        –û–±—â–∏–π —Ä–∏—Å–∫ –æ—Ç –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏: ${(totalRisk * 100).toFixed(1)}%<br>
                        P(–∑–¥–æ—Ä–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏) = 1 - ${totalRisk.toFixed(4)} = ${pNoLifestyleIssues.toFixed(4)} (${(pNoLifestyleIssues * 100).toFixed(2)}%)
                    </div>
                </div>
                
                <div class="calculation-step">
                    <h4>–ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞—Å—á—ë—Ç:</h4>
                    <div class="calculation-formula">
                        P(–∑–¥–æ—Ä–æ–≤—å—è) = P(–±–µ–∑ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏–π) √ó P(–∑–¥–æ—Ä–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏)<br>
                        = ${pNoComplications.toFixed(4)} √ó ${pNoLifestyleIssues.toFixed(4)} ‚âà ${pHealth.toFixed(4)} (${(pHealth * 100).toFixed(2)}%)
                    </div>
                    <p>–í—ã–≤–æ–¥: ${pHealth >= 0.5 ? '—É–º–µ—Ä–µ–Ω–Ω–∞—è' : '–Ω–∏–∑–∫–∞—è'} –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –ø—Ä–∏ —Ç–µ–∫—É—â–µ–º –æ–±—Ä–∞–∑–µ –∂–∏–∑–Ω–∏.</p>
                    ${children > 0 ? '<p>–ù–∞–ª–∏—á–∏–µ –¥–µ—Ç–µ–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ.</p>' : ''}
                    ${badHabits !== '0' ? '<p>–í—Ä–µ–¥–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∂–∞—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è.</p>' : ''}
                </div>
            `;

            document.getElementById('health-current-calculation').innerHTML = calculationHTML;

            return pHealth * 100;
        }

        function calculateITHealth() {
            const years = parseFloat(document.getElementById('years').value);

            // –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            const totalIllnesses = 3 * years; // –ë–æ–ª–µ–∑–Ω–∏ –∑–∞ –≥–æ–¥—ã
            const complicationRiskPerIllness = 0.98; // 2% —Ä–∏—Å–∫ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏–π –Ω–∞ –±–æ–ª–µ–∑–Ω—å
            const burnoutRiskReduction = 1.20; // –ë–∞–ª–∞–Ω—Å —Ä–∞–±–æ—Ç—ã/–æ—Ç–¥—ã—Ö–∞ —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∏—Å–∫ –Ω–∞ 20%
            const baseBurnoutRisk = 0.80; // –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏–∑–±–µ–∂–∞—Ç—å –≤—ã–≥–æ—Ä–∞–Ω–∏—è

            // –†–∞—Å—á–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∏–∑–±–µ–∂–∞—Ç—å –æ—Å–ª–æ–∂–Ω–µ–Ω–∏–π
            const healthWithoutComplications = Math.pow(complicationRiskPerIllness, totalIllnesses);

            // –†–∞—Å—á–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∏–∑–±–µ–∂–∞—Ç—å –≤—ã–≥–æ—Ä–∞–Ω–∏—è
            const healthWithoutBurnout = baseBurnoutRisk * burnoutRiskReduction;

            // –ò—Ç–æ–≥–æ–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–¥–æ—Ä–æ–≤—å—è
            const finalHealth = healthWithoutComplications * healthWithoutBurnout;

            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML —Å —Ä–∞—Å—á–µ—Ç–∞–º–∏
            const calculationHTML = `
        <div class="calculation-step">
            –†–∏—Å–∫–∏:<br>
            - –°–∏–¥—è—á–∞—è —Ä–∞–±–æ—Ç–∞: +30% –∫ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–º –±–æ–ª–µ–∑–Ω—è–º (—É–º–µ–Ω—å—à–µ–Ω–æ –¥–æ 10% –∑–∞ —Å—á–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)<br>
            - –°—Ç—Ä–µ—Å—Å –æ—Ç –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–æ–∫: 40% —Ä–∏—Å–∫ –≤—ã–≥–æ—Ä–∞–Ω–∏—è (—É–º–µ–Ω—å—à–µ–Ω–æ –¥–æ 20% –∑–∞ —Å—á–µ—Ç —É–¥–∞–ª–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏ –ü–ü)<br>
            - –ë–∞–ª–∞–Ω—Å —Ä–∞–±–æ—Ç—ã/–æ—Ç–¥—ã—Ö–∞: -20% –∫ —Ä–∏—Å–∫–∞–º (–æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥)<br><br>
            
            –ë–æ–ª–µ–∑–Ω–∏/–≥–æ–¥: 3 (—Å —É—á–µ—Ç–æ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –ü–ü)<br>
            –û—Å–ª–æ–∂–Ω–µ–Ω–∏—è: 2% –Ω–∞ –±–æ–ª–µ–∑–Ω—å<br><br>
            
            <strong>–†–∞—Å—á—ë—Ç:</strong><br>
            1. –û—Å–ª–æ–∂–Ω–µ–Ω–∏—è –∑–∞ ${years} –ª–µ—Ç:<br>
            <div class="calculation-formula">
                P(–∑–¥–æ—Ä–æ–≤—å—è) = 0.98^${totalIllnesses} ‚âà ${healthWithoutComplications.toFixed(4)} (${(healthWithoutComplications * 100).toFixed(2)}%)<br>
            </div>
            2. –°—Ç—Ä–µ—Å—Å:<br>
            <div class="calculation-formula">
                P(–±–µ–∑ –≤—ã–≥–æ—Ä–∞–Ω–∏—è) = 0.80 √ó 1.20 = ${healthWithoutBurnout.toFixed(2)} (${(healthWithoutBurnout * 100).toFixed(2)}%)<br>
            </div>
            3. –ò—Ç–æ–≥:<br>
            <div class="calculation-formula">
                ${healthWithoutComplications.toFixed(4)} √ó ${healthWithoutBurnout.toFixed(2)} ‚âà ${finalHealth.toFixed(4)} (${(finalHealth * 100).toFixed(2)}%)<br>
                P(–∑–¥–æ—Ä–æ–≤—å—è) = ${(finalHealth * 100).toFixed(2)}%
            </div>
        </div>
    `;

            document.getElementById('health-it-calculation').innerHTML = calculationHTML;

            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Ç–æ–≥–æ–≤—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–¥–æ—Ä–æ–≤—å—è
            return finalHealth * 100; // –ò—Ç–æ–≥–æ–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
        }


        function calculateCurrentHappiness() {
            const jobSatisfaction = parseFloat(document.getElementById('current-job-satisfaction').value) / 10;
            const relationshipStatus = document.getElementById('current-relationship-status').value;
            let relationship = relationshipStatus === '0' ? 0 : parseFloat(document.getElementById('current-relationship').value) / 10;
            const stressLevel = parseFloat(document.getElementById('current-stress').value) / 10;
            const children = parseInt(document.getElementById('current-children').value);
            const financialStability = parseFloat(document.getElementById('current-income').value) / parseFloat(document.getElementById('current-expenses').value);

            // Calculate happiness based on factors with weights
            const weights = {
                job: 0.3,
                relationship: relationshipStatus === '0' ? 0 : 0.3,
                stress: 0.2,
                children: children > 0 ? 0.1 : 0,
                finances: 0.1,
                freedom: relationshipStatus === '0' ? 0.1 : 0 // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–≤–æ–±–æ–¥–∞, –µ—Å–ª–∏ –Ω–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö
            };

            // Adjust relationship satisfaction based on stress
            const adjustedRelationship = relationship * (1 - stressLevel * 0.3);

            // Normalize factors
            const jobFactor = jobSatisfaction;
            const relationshipFactor = adjustedRelationship;
            const stressFactor = 1 - stressLevel;
            const childrenFactor = children > 0 ? 0.7 : 1; // Children reduce happiness by 30%
            const financesFactor = Math.min(1, financialStability / 1.5);
            const freedomFactor = relationshipStatus === '0' ? 0.8 : 0.2; // –ë–æ–ª—å—à–µ —Å–≤–æ–±–æ–¥—ã, –µ—Å–ª–∏ –Ω–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö

            // Calculate weighted happiness
            let pHappy = jobFactor * weights.job +
                relationshipFactor * weights.relationship +
                stressFactor * weights.stress +
                childrenFactor * (children > 0 ? weights.children : 0) +
                financesFactor * weights.finances +
                freedomFactor * weights.freedom;

            // Normalize to account for possible weight variations
            const totalWeight = weights.job + weights.relationship + weights.stress +
                (children > 0 ? weights.children : 0) + weights.finances + weights.freedom;
            pHappy /= totalWeight;

            // Generate calculation steps for modal
            let calculationHTML = `
                <div class="calculation-step">
                    <ul>
                        <li>–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–æ–π: ${jobSatisfaction * 10}/10</li>
                        <li>${relationshipStatus === '0' ? '–ù–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö' : '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏: ' + (relationship * 10) + '/10'}</li>
                        <li>–£—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞: ${stressLevel * 10}/10</li>
                        <li>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–π: ${children}</li>
                        <li>–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (–¥–æ—Ö–æ–¥/—Ä–∞—Å—Ö–æ–¥): ${financialStability.toFixed(2)}</li>
                    </ul>
                </div>
                
                <div class="calculation-step">
                    <h4>–†–∞—Å—á—ë—Ç —Å –≤–µ—Å–æ–≤—ã–º–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏:</h4>
                    <div class="calculation-formula">
                        P(—Å—á–∞—Å—Ç—å—è) = (–†–∞–±–æ—Ç–∞ √ó ${(weights.job * 100).toFixed(0)}%) 
                        ${relationshipStatus !== '0' ? '+ (–û—Ç–Ω–æ—à–µ–Ω–∏—è √ó ' + (weights.relationship * 100).toFixed(0) + '%)' : ''}
                        + (–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–µ—Å—Å–∞ √ó ${(weights.stress * 100).toFixed(0)}%) 
                        ${children > 0 ? '+ (–î–µ—Ç–∏ √ó ' + (weights.children * 100).toFixed(0) + '%)' : ''}
                        + (–§–∏–Ω–∞–Ω—Å—ã √ó ${(weights.finances * 100).toFixed(0)}%)
                        ${relationshipStatus === '0' ? '+ (–°–≤–æ–±–æ–¥–∞ √ó ' + (weights.freedom * 100).toFixed(0) + '%)' : ''}
                        
                        = (${jobFactor.toFixed(2)} √ó ${weights.job.toFixed(2)}) 
                        ${relationshipStatus !== '0' ? '+ (' + relationshipFactor.toFixed(2) + ' √ó ' + weights.relationship.toFixed(2) + ')' : ''}
                        + (${stressFactor.toFixed(2)} √ó ${weights.stress.toFixed(2)}) 
                        ${children > 0 ? '+ (' + childrenFactor.toFixed(2) + ' √ó ' + weights.children.toFixed(2) + ')' : ''}
                        + (${financesFactor.toFixed(2)} √ó ${weights.finances.toFixed(2)})
                        ${relationshipStatus === '0' ? '+ (' + freedomFactor.toFixed(2) + ' √ó ' + weights.freedom.toFixed(2) + ')' : ''}
                        
                        = ${(jobFactor * weights.job).toFixed(2)} 
                        ${relationshipStatus !== '0' ? '+ ' + (relationshipFactor * weights.relationship).toFixed(2) : ''}
                        + ${(stressFactor * weights.stress).toFixed(2)} 
                        ${children > 0 ? '+ ' + (childrenFactor * weights.children).toFixed(2) : ''}
                        + ${(financesFactor * weights.finances).toFixed(2)}
                        ${relationshipStatus === '0' ? '+ ' + (freedomFactor * weights.freedom).toFixed(2) : ''}
                        
                        = ${pHappy.toFixed(4)} (${(pHappy * 100).toFixed(2)}%)
                    </div>
                </div>
                
                <div class="calculation-step">
                    <h4>–í—ã–≤–æ–¥:</h4>
                    <p>${pHappy >= 0.7 ? '–í—ã—Å–æ–∫–∞—è' : pHappy >= 0.5 ? '–£–º–µ—Ä–µ–Ω–Ω–∞—è' : '–ù–∏–∑–∫–∞—è'} –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—á–∞—Å—Ç—å—è –ø—Ä–∏ —Ç–µ–∫—É—â–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö –∂–∏–∑–Ω–∏.</p>
                    ${children > 0 ? '<p>–ù–∞–ª–∏—á–∏–µ –¥–µ—Ç–µ–π –≤–ª–∏—è–µ—Ç –Ω–∞ —É—Ä–æ–≤–µ–Ω—å —Å—á–∞—Å—Ç—å—è.</p>' : ''}
                    ${stressLevel > 0.5 ? '<p>–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –∂–∏–∑–Ω—å—é.</p>' : ''}
                    ${relationshipStatus === '0' ? '<p>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç—Å—è –±–æ–ª—å—à–µ–π —Å–≤–æ–±–æ–¥–æ–π.</p>' : ''}
                </div>
            `;

            document.getElementById('happy-current-calculation').innerHTML = calculationHTML;

            return pHappy * 100;
        }

        function calculateITHappiness() {
            const years = parseFloat(document.getElementById('years').value);

            // –†–∞—Å—á–µ—Ç –¥–ª—è IT —Å—Ü–µ–Ω–∞—Ä–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
            let calculationHTML = `
                <div class="calculation-steps">
                <div class="calculation-step">
                    <table style="width: 100%; margin-bottom: 20px;">
                        <tr>
                            <th>–§–∞–∫—Ç–æ—Ä</th>
                            <th>–†–∏—Å–∫</th>
                            <th>–í–µ—Å</th>
                        </tr>
                        <tr>
                            <td>–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</td>
                            <td>15%</td>
                            <td>25%</td>
                        </tr>
                        <tr>
                            <td>–ì–∞—Ä–º–æ–Ω–∏—á–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è</td>
                            <td>20%</td>
                            <td>30%</td>
                        </tr>
                        <tr>
                            <td>–°–∞–º–æ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</td>
                            <td>10%</td>
                            <td>20%</td>
                        </tr>
                        <tr>
                            <td>–°–≤–æ–±–æ–¥–∞ –≤—ã–±–æ—Ä–∞</td>
                            <td>5%</td>
                            <td>15%</td>
                        </tr>
                        <tr>
                            <td>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏</td>
                            <td>10%</td>
                            <td>10%</td>
                        </tr>
                    </table>
                </div>
                
                <div class="calculation-step">
                    <h4>–†–∞—Å—á—ë—Ç:</h4>
                    <div class="calculation-formula">
                        –û–±—â–∏–π —Ä–∏—Å–∫ –Ω–µ—Å—á–∞—Å—Ç—å—è = Œ£(–†–∏—Å–∫ √ó –í–µ—Å)
                        = (0.15√ó0.25) + (0.2√ó0.3) + (0.1√ó0.2) + (0.05√ó0.15) + (0.1√ó0.1)<br>
                        = 0.0375 + 0.06 + 0.02 + 0.0075 + 0.01 = 0.135 (13.5%)<br><br>
                        
                        P(happy) = 1 - 0.135 = 0.865 (86.5%)
                    </div>
                </div>
            
                    <p>–í—ã–≤–æ–¥: –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—á–∞—Å—Ç—å—è –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º —É—Å–ª–æ–≤–∏—è–º –∂–∏–∑–Ω–∏ –∏ —Ä–∞–±–æ—Ç—ã.</p>
                </div>
            `;

            document.getElementById('happy-it-calculation').innerHTML = calculationHTML;

            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 85.5% —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
            return 86.5;
        }

        function calculateCurrentSuccess() {
            const pMoney = calculateCurrentMoney() / 100;
            const pHealth = calculateCurrentHealth() / 100;
            const pHappy = calculateCurrentHappiness() / 100;

            const pSuccess = pMoney * pHealth * pHappy;

            // Generate calculation steps for modal
            let calculationHTML = `
                <div class="calculation-step">
                    <h4>–ò—Ç–æ–≥–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞:</h4>
                    <div class="calculation-formula">
                        P(—É—Å–ø–µ—Ö–∞) = P(–¥–µ–Ω—å–≥–∏) √ó P(–∑–¥–æ—Ä–æ–≤—å–µ) √ó P(—Å—á–∞—Å—Ç—å–µ)
                    </div>
                </div>
                
                <div class="calculation-step">
                    <h4>–†–∞—Å—á—ë—Ç:</h4>
                    <div class="calculation-formula">
                        ${(pMoney).toFixed(4)} √ó ${(pHealth).toFixed(4)} √ó ${(pHappy).toFixed(4)} ‚âà ${pSuccess.toFixed(4)} (${(pSuccess * 100).toFixed(2)}%)
                    </div>
                    <p>–í—ã–≤–æ–¥: ${pSuccess >= 0.1 ? '–∑–∞–º–µ—Ç–Ω–∞—è' : '–Ω–µ–±–æ–ª—å—à–∞—è'} –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏—á—å –≤—Å–µ—Ö —Ç—Ä—ë—Ö —Ü–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–∏ —Ç–µ–∫—É—â–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö.</p>
                </div>
            `;

            document.getElementById('success-current-calculation').innerHTML = calculationHTML;

            return pSuccess * 100;
        }

        function calculateITSuccess() {
            const pMoney = calculateITMoney() / 100;
            const pHealth = calculateITHealth() / 100;
            const pHappy = calculateITHappiness() / 100;

            const pSuccess = pMoney * pHealth * pHappy;

            // Generate calculation steps for modal
            let calculationHTML = `
                <div class="calculation-step">
                    <h4>–ò—Ç–æ–≥–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞:</h4>
                    <div class="calculation-formula">
                        P(—É—Å–ø–µ—Ö–∞) = P(–¥–µ–Ω—å–≥–∏) √ó P(–∑–¥–æ—Ä–æ–≤—å–µ) √ó P(—Å—á–∞—Å—Ç—å–µ)
                    </div>
                </div>
                
                <div class="calculation-step">
                    <h4>–†–∞—Å—á—ë—Ç:</h4>
                    <div class="calculation-formula">
                        ${(pMoney).toFixed(4)} √ó ${(pHealth).toFixed(4)} √ó ${(pHappy).toFixed(4)} ‚âà ${pSuccess.toFixed(4)} (${(pSuccess * 100).toFixed(2)}%)
                    </div>
                    <p>–í—ã–≤–æ–¥: –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏—á—å –≤—Å–µ—Ö —Ç—Ä—ë—Ö —Ü–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚Äî –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ, —á–µ–º –≤ —Ç–µ–∫—É—â–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏.</p>
                </div>
            `;

            document.getElementById('success-it-calculation').innerHTML = calculationHTML;

            return pSuccess * 100;
        }

        function updateCalculations() {
            // Calculate and update all values
            const currentMoney = calculateCurrentMoney();
            const itMoney = calculateITMoney();
            const currentHealth = calculateCurrentHealth();
            const itHealth = calculateITHealth();
            const currentHappy = calculateCurrentHappiness();
            const itHappy = calculateITHappiness();
            const currentSuccess = calculateCurrentSuccess();
            const itSuccess = calculateITSuccess();

            // Update table values
            document.getElementById('current-money').textContent = formatPercent(currentMoney);
            document.getElementById('it-money').textContent = formatPercent(itMoney);
            document.getElementById('current-health').textContent = formatPercent(currentHealth);
            document.getElementById('it-health').textContent = formatPercent(itHealth);
            document.getElementById('current-happy').textContent = formatPercent(currentHappy);
            document.getElementById('it-happy').textContent = formatPercent(itHappy);
            document.getElementById('current-success').textContent = formatPercent(currentSuccess);
            document.getElementById('it-success').textContent = formatPercent(itSuccess);

            // Update color classes based on values
            updateValueClass('current-money', currentMoney);
            updateValueClass('it-money', itMoney);
            updateValueClass('current-health', currentHealth);
            updateValueClass('it-health', itHealth);
            updateValueClass('current-happy', currentHappy);
            updateValueClass('it-happy', itHappy);
            updateValueClass('current-success', currentSuccess);
            updateValueClass('it-success', itSuccess);
        }

        function updateValueClass(elementId, value) {
            const element = document.getElementById(elementId);
            element.classList.remove('bad-value', 'good-value');

            if (value < 30) {
                element.classList.add('bad-value');
            } else {
                element.classList.add('good-value');
            }
        }

        // Initialize calculations on page load
        window.onload = function () {
            updateCalculations();

            // Disable relationship satisfaction if not in relationship
            const relationshipStatus = document.getElementById('current-relationship-status');
            const relationshipInput = document.getElementById('current-relationship');
            if (relationshipStatus.value === '0') {
                relationshipInput.disabled = true;
                relationshipInput.value = '1';
            }

            relationshipStatus.addEventListener('change', function () {
                if (this.value === '0') {
                    relationshipInput.disabled = true;
                    relationshipInput.value = '1';
                } else {
                    relationshipInput.disabled = false;
                    relationshipInput.value = this.value;
                }
            });
        };

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–∞–ª–∏—Ç—Ä—ã
        function toggleColorOptions() {
            const colorOptions = document.getElementById('colorOptions');
            colorOptions.classList.toggle('show');
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ –∫–Ω–æ–ø–∫–∏ –ø–∞–ª–∏—Ç—Ä—ã
        function updatePaletteButton() {
            const paletteButton = document.querySelector('.palette-button');
            const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--primary').trim();
            const accentColor = getComputedStyle(document.documentElement).getPropertyValue('--accent').trim();

            paletteButton.style.background = `linear-gradient(45deg, ${primaryColor}, ${accentColor})`;
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Ç–µ–º—ã
        function applyTheme(theme) {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º inline —Å—Ç–∏–ª–∏ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ç–µ–º—ã
            document.documentElement.removeAttribute('style');
            document.documentElement.className = theme;
            localStorage.setItem('selectedTheme', theme);
            updatePaletteButton();

            // –ï—Å–ª–∏ –ø—Ä–∏–º–µ–Ω—è–µ–º –Ω–µ –∫–∞—Å—Ç–æ–º–Ω—É—é —Ç–µ–º—É, –æ—á–∏—â–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            if (theme !== 'custom') {
                localStorage.removeItem('customTheme');
            }
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ç–æ—Ä–∞ —Ü–≤–µ—Ç–æ–≤
        function openColorCustomizer() {
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
            const root = document.documentElement;
            const currentPrimary = getComputedStyle(root).getPropertyValue('--primary').trim();
            const currentAccent = getComputedStyle(root).getPropertyValue('--accent').trim();
            const currentBg = getComputedStyle(root).getPropertyValue('--background').trim();
            const currentText = getComputedStyle(root).getPropertyValue('--text').trim();
            const currentCard = getComputedStyle(root).getPropertyValue('--card-bg').trim();
            const currentBad = getComputedStyle(root).getPropertyValue('--bad-value').trim();
            const currentGood = getComputedStyle(root).getPropertyValue('--good-value').trim();

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∏–Ω–ø—É—Ç—ã
            document.getElementById('primaryColor').value = rgbToHex(currentPrimary);
            document.getElementById('accentColor').value = rgbToHex(currentAccent);
            document.getElementById('bgColor').value = rgbToHex(currentBg);
            document.getElementById('textColor').value = rgbToHex(currentText);
            document.getElementById('cardColor').value = rgbToHex(currentCard);
            document.getElementById('badColor').value = rgbToHex(currentBad);
            document.getElementById('goodColor').value = rgbToHex(currentGood);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ç–æ—Ä
            document.getElementById('colorCustomizer').style.display = 'block';
            toggleColorOptions();
        }

        function rgbToHex(rgb) {
            // –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —É–∂–µ –≤ HEX —Ñ–æ—Ä–º–∞—Ç–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
            if (rgb.startsWith('#')) return rgb;

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ RGB/RGBA –∑–Ω–∞—á–µ–Ω–∏–π
            const sep = rgb.indexOf(",") > -1 ? "," : " ";
            const rgbArray = rgb.substr(4).split(")")[0].split(sep);

            let r = (+rgbArray[0]).toString(16),
                g = (+rgbArray[1]).toString(16),
                b = (+rgbArray[2]).toString(16);

            if (r.length == 1) r = "0" + r;
            if (g.length == 1) g = "0" + g;
            if (b.length == 1) b = "0" + b;

            return "#" + r + g + b;
        }


        // –ó–∞–∫—Ä—ã—Ç–∏–µ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ç–æ—Ä–∞ —Ü–≤–µ—Ç–æ–≤
        function closeColorCustomizer() {
            document.getElementById('colorCustomizer').style.display = 'none';
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ç–µ–º—ã
        function applyCustomColors(primary, accent, bg, text, card, bad, good) {
            const root = document.documentElement;
            root.style.setProperty('--primary', primary);
            root.style.setProperty('--accent', accent);
            root.style.setProperty('--background', bg);
            root.style.setProperty('--text', text);
            root.style.setProperty('--card-bg', card);
            root.style.setProperty('--bad-value', bad);
            root.style.setProperty('--good-value', good);

            // –£–¥–∞–ª—è–µ–º –∫–ª–∞—Å—Å—ã —Ç–µ–º, —á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞
            root.className = '';

            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π
            document.querySelectorAll('.bad-value, .good-value').forEach(el => {
                el.style.color = 'inherit';
                void el.offsetWidth; // Trigger reflow
                el.style.color = '';
            });

            updatePaletteButton();
            saveCustomTheme(primary, accent, bg, text, card, bad, good);
        }


        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ç–æ—Ä–∞
        window.addEventListener('click', function (event) {
            const customizer = document.getElementById('colorCustomizer');
            if (event.target === customizer) {
                closeColorCustomizer();
            }
        });
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –ø–∞–ª–∏—Ç—Ä—ã
        document.addEventListener('click', function (event) {
            const palette = document.querySelector('.theme-palette');
            const colorOptions = document.getElementById('colorOptions');
            const paletteButton = document.querySelector('.palette-button');

            // –ï—Å–ª–∏ –∫–ª–∏–∫ –Ω–µ –ø–æ –ø–∞–ª–∏—Ç—Ä–µ –∏ –ø–∞–ª–∏—Ç—Ä–∞ –æ—Ç–∫—Ä—ã—Ç–∞
            if (!palette.contains(event.target) && colorOptions.classList.contains('show')) {
                colorOptions.classList.remove('show');
            }
        });

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π —Ç–µ–º—ã
        function saveCustomTheme(primary, accent, bg, text, card, bad, good) {
            localStorage.setItem('customTheme', JSON.stringify({
                primary,
                accent,
                bg,
                text,
                card,
                bad,
                good
            }));
            localStorage.setItem('selectedTheme', 'custom');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–π —Ç–µ–º—ã
        function loadCustomTheme() {
            const customTheme = localStorage.getItem('customTheme');
            if (customTheme) {
                const theme = JSON.parse(customTheme);
                applyCustomColors(
                    theme.primary,
                    theme.accent,
                    theme.bg,
                    theme.text,
                    theme.card,
                    theme.bad || '#ff6b8b',  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å fallback
                    theme.good || '#6ddea7'   // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å fallback
                );
            }
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–ª–∞—Å—Å–∞
        function applyCustomTheme() {
            const primaryColor = document.getElementById('primaryColor').value;
            const accentColor = document.getElementById('accentColor').value;
            const bgColor = document.getElementById('bgColor').value;
            const textColor = document.getElementById('textColor').value;
            const cardColor = document.getElementById('cardColor').value;
            const badColor = document.getElementById('badColor').value;
            const goodColor = document.getElementById('goodColor').value;

            applyCustomColors(primaryColor, accentColor, bgColor, textColor, cardColor, badColor, goodColor);
            closeColorCustomizer();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–º—ã
        window.onload = function () {
            updateCalculations();

            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã
            const savedTheme = localStorage.getItem('selectedTheme');
            if (savedTheme === 'custom') {
                loadCustomTheme();
            } else if (savedTheme) {
                document.documentElement.className = savedTheme;
            } else {
                document.documentElement.className = 'theme-dark'; // —Ç–µ–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            }

            updatePaletteButton();

            // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏...
            const relationshipStatus = document.getElementById('current-relationship-status');
            const relationshipInput = document.getElementById('current-relationship');
            if (relationshipStatus.value === '0') {
                relationshipInput.disabled = true;
                relationshipInput.value = '1';
            }

            relationshipStatus.addEventListener('change', function () {
                if (this.value === '0') {
                    relationshipInput.disabled = true;
                    relationshipInput.value = '1';
                } else {
                    relationshipInput.disabled = false;
                    relationshipInput.value = this.value;
                }
            });
        };
    </script>
</body>

</html>